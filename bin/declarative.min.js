/*

 declarative - may the source be with you - version 0.5.0

 Copyright 2011, Alex Lawrence
 Licensed under the MIT license.
 http://www.opensource.org/licenses/MIT

*/
(function(a){a.declarative={}})(window);(function(a){a.versionOfInternetExplorer=function(){var a=-1;navigator.appName=="Microsoft Internet Explorer"&&/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)!=null&&(a=parseFloat(RegExp.$1));return a}})(declarative);(function(a){var e=a.array={};e.ensureArray=function(a){return e.isArray(a)?a:[a]};e.isArray=function(a){return Object.prototype.toString.call(a)==="[object Array]"};e.indexOf=function(a,e){for(var b=0,d=a.length;b<d;b++)if(a[b]==e)return b;return-1}})(declarative);(function(a,e){a.parseOptions=function(a){try{return d(a)}catch(b){throw Error("declarative.parseOptions: JSON parsing error");}};var i,h=RegExp(/'/g),b=RegExp(/(^|,)(\w+)\s*:/g),d=e()==7?function(a){eval("var output = {"+a+"};");return output}:function(a){a=a.replace(b,'$1"$2":');a=a.replace(h,'"');return JSON.parse("{"+a+"}")}})(declarative,declarative.versionOfInternetExplorer);(function(a,e,i){a.mappings={};a.mappings.clear=function(){k={}};a.mappings.add=function(a){for(var a=e(a),l=0,p=a.length;l<p;l++){var j=a[l],c=j;c||b("add","invalid options");c.id||b("add","missing id");c.prefix||b("add","missing prefix");c.types||b("add","missing types");c.types&&!c.types.push&&b("add","invalid types");(!c.callback||typeof c.callback!=="function")&&b("add","invalid callback");var f;a:{f=c.id;var g=void 0;for(g in k)if(k.hasOwnProperty(g)&&g==f){f=true;break a}f=false}f&&b("add",
'duplicate id "'+c.id+'"');c=j;c.prefix=c.prefix.toLowerCase();c.typesAsAttributes=[];f=0;for(g=c.types.length;f<g;f++){var h=d(c.types[f]);c.typesAsAttributes.push(c.prefix+h)}k[j.id]=j}};a.mappings.get=function(a){if(!i(a))return h(a);for(var b=[],d=0,e=a.length;d<e;d++)b.push(h(a[d]));return b};var h=function(a){k[a]||b("get",'invalid id "'+a+'"');return k[a]},b=function(a,b){throw Error("declarative.mappings."+a+": "+b);},d=function(a){return a.replace(o,function(a,b){return"-"+b.toLowerCase()})},
k={},o=RegExp(/([A-Z])/g)})(declarative,declarative.array.ensureArray,declarative.array.isArray);(function(a,e,i){a.apply=function(e){var b=a.mappings.get(e),b=i(b);return{to:function(d){var e=b;if(!d||typeof d.nodeName!=="string")throw Error("declarative.apply.to: invalid element (DOM object required)");for(var h=d.all?d.all:d.getElementsByTagName("*"),m,l,i=h.length,j,c=0,f=e.length,g=0,n=0;d;){for(c=0;c<f;c++){m=e[c];for(g=0,n=m.typesAsAttributes.length;g<n;g++)if(j=d.getAttribute&&d.getAttribute(m.typesAsAttributes[g]))l=m.types[g],m.callback(d,l,a.parseOptions(j))}d=i&&h[--i]}}}}})(declarative,
declarative.array.indexOf,declarative.array.ensureArray);
