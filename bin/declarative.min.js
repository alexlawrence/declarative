/*

 declarative - HTML parsing library
 Requires JSON.parse

 Copyright 2011, Alex Lawrence
 Licensed under the MIT license.
 http://www.opensource.org/licenses/MIT

*/
(function(a){a.declarative={}})(window);(function(a){a.parseOptions=function(a){a.indexOf('"')>-1&&c("input contains double quotes");try{return a=a.replace(g,'$1"$2":'),a=a.replace(d,'"'),JSON.parse("{"+a+"}")}catch(i){c("JSON parsing error")}};var c=function(a){throw Error("declarative.parseOptions: "+a);},d=RegExp(/'/g),g=RegExp(/(^|,)(\w+)\s*:/g)})(declarative);(function(a){a.mappings={};a.mappings.clear=function(){d={}};a.mappings.add=function(a){a||c("add","invalid options");a.id||c("add","missing id");a.attributePrefix||c("add","missing attributePrefix");d[a.id]=a};a.mappings.get=function(a){d[a]||c("get",'invalid id "'+a+'"');return d[a]};var c=function(a,c){throw Error("declarative.mappings."+a+": "+c);},d={}})(declarative);(function(a){a.apply=function(l){var e=a.mappings.get(l);return{to:function(a){c(e,a)}}};var c=function(a,e){if(!e||typeof e.nodeName!=="string")throw Error("declarative.apply.to: invalid element (DOM object required)");for(var b=a.attributePrefix,c=a.callback,f=a.types,j=e.getElementsByTagName("*"),h=e,g=j.length;h;)d(h.attributes,b,function(a,e){var b;if(!(b=!f)){a:{b=0;for(var d=f.length;b<d;b++)if(f[b]===a)break a;b=-1}b=b>-1}b&&c(h,a,e)}),h=g>0&&j[--g]},d=function(c,e,b){g(c,function(c,f){if(c.indexOf(e)===
0){var d=k(c,e),g=a.parseOptions(f);b(d,g)}})},g=function(a,c){var b,d=a.length,f;for(b=0;b<d;b++)f=a[b],c(f.nodeName,f.nodeValue)},k=function(a,c){var b=a.substring(c.length),b=b.toLowerCase();return b=b.replace(i,function(a,b){return b.toUpperCase()})},i=RegExp(/-(.)/g)})(declarative);
