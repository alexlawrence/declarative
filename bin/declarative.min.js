/*

 declarative - Mapper for custom user interface markup - version 1.3.9
 Copyright 2012, Alex Lawrence
 Licensed under the MIT license.
 http://www.opensource.org/licenses/MIT
*/
(function(l,e){"object"===typeof exports?module.exports=e():"function"===typeof define&&define.amd?define(e):l.declarative=e()})(this,function(){var l=function(a){var b=a.exports;b.attribute="attribute";b.element="element";return a.exports}({exports:{}}),e=function(a){var b=a.exports;b.parseOptions="declarative: Error parsing options";b.verifyDomElement="declarative: Invalid DOM element given";b.getSingleMapping="declarative: Mapping id not existing";b.validateMapping="declarative: Invalid mapping options";
b.validateMappingId="declarative: Invalid mapping id";b.validateMappingTypes="declarative: Missing mapping types";b.validateMappingTypesFormat="declarative: Invalid mapping types";b.validateMappingCallback="declarative: Invalid mapping callback";b.validateMappingMode="declarative: Invalid mappingMode";return a.exports}({exports:{}}),B=function(a){var b=RegExp(/([A-Z])/g);a.exports=function(a){return a.replace(b,function(b,a){return"-"+a.toLowerCase()})};return a.exports}({exports:{}}),C=function(a){var b=
function(b){throw Error(b);};a.exports=function(a){a||b(e.validateMapping);a.id||b(e.validateMappingId);a.types||b(e.validateMappingTypes);a.types&&!a.types.push&&b(e.validateMappingTypesFormat);(!a.callback||"function"!==typeof a.callback)&&b(e.validateMappingCallback);a.mappingMode&&(a.mappingMode!==l.attribute&&a.mappingMode!==l.element)&&b(e.validateMappingMode)};return a.exports}({exports:{}}),D=function(a){a.exports=function(b){b.prefix=b.prefix||"";b.mappingMode=b.mappingMode||l.attribute;
b.distinct=void 0!==b.distinct?b.distinct:!0};return a.exports}({exports:{}}),E=function(a){a.exports=function(b){b.prefix=b.prefix.toLowerCase();b.convertedTypes=[];for(var a=0,c=b.types.length;a<c;a++){var f=B(b.types[a]);b.convertedTypes.push(b.prefix+f)}};return a.exports}({exports:{}}),u=function(a){var b={ensureArray:function(a){return b.isArray(a)?a:[a]},isArray:function(b){return"[object Array]"===Object.prototype.toString.call(b)},indexOf:function(b,a){for(var f=0,k=b.length;f<k;f++)if(b[f]==
a)return f;return-1}};a.exports=b;return a.exports}({exports:{}}),y=function(a){a.exports=function(b){return b&&(1===b.nodeType||9===b.nodeType)};return a.exports}({exports:{}}),F=function(a){a.exports=function(b){var a;(a=b[l.attribute].join("],["))&&(a="["+a+"]");b=b[l.element].join(",");return a+(a&&b?",":"")+b};return a.exports}({exports:{}}),q=function(a){var b={clear:function(){c={}},add:function(a){a=u.ensureArray(a);for(var k=0,d=a.length;k<d;k++){var h=a[k];C(h);D(h);E(h);c[h.id]=h}return b},
getAll:function(){var b=[],a;for(a in c)c.hasOwnProperty(a)&&b.push(c[a]);return b},get:function(b){if(!u.isArray(b))return c[b]||d();for(var a=[],g=0,h=b.length;g<h;g++)a.push(c[b[g]]||d());return a}},d=function(){throw Error(e.getSingleMapping);},c={};a.exports=b;return a.exports}({exports:{}}),x=function(a){var b=a.exports;b.mappingTimeoutMs=1E3;b.mappingWaitTimeMs=20;return a.exports}({exports:{}}),G=function(a){a.exports=function(b){try{return eval("output = {"+b+"}")}catch(a){throw Error(e.parseOptions);
}};return a.exports}({exports:{}}),H=function(a){a.exports=function(b){var a,c=function(){a=(new Date).getTime();b(f,k)},f=function(){return(new Date).getTime()-a},k=function(b){setTimeout(c,b)};c()};return a.exports}({exports:{}}),I=function(a){var b=function(){if(!(this instanceof b))return new b;var a=null,k,g,h=[],m=[];this.then=function(d,e){var l=new b;e=e||function(){};d=c(this,d||function(){},l);"resolved"==a&&d.apply(this,k);"rejected"==a&&e.apply(this,g);h.push(d);m.push(e);return l};this.resolve=
function(){a||(k=arguments,d(this,h,k),a="resolved")};this.reject=function(){a||(g=arguments,d(this,m,g),a="rejected")}},d=function(a,b,c){for(var h=0,d=b.length;h<d;h++)b[h].apply(a,c)},c=function(a,b,c){return function(){try{c.resolve(b.apply(a,arguments))}catch(h){c.reject(h)}}};a.exports=b;return a.exports}({exports:{}}),J=function(a){a.exports=function(a){if(!y(a))throw Error(e.verifyDomElement);a=a.attributes;for(var d,c={},f=0,k=a.length;f<k;f++)d=a[f],d.specified&&(c[d.nodeName]=d.nodeValue);
return c};return a.exports}({exports:{}}),K=function(a){a.exports=function(a,d){if(a.querySelectorAll){var c={};c[l.attribute]=[];c[l.element]=[];for(var f=0,e=d.length;f<e;f++){var g=d[f],h=g.mappingMode;c[h]=c[h].concat(g.convertedTypes)}c=F(c);return a.querySelectorAll(c)}return a.all?a.all:a.getElementsByTagName("*")};return a.exports}({exports:{}}),w=function(a){var b=function(a){return{to:function(b){return d(a,b)}}},d=function(a,b){if(!y(b))throw Error(e.verifyDomElement);var d=K(b,a),g,q=
d.length,t=b!=document?b:d[--q],v=0,w=a.length,s=0,z=0,A=new I;H(function(b,e){for(;t;){for(v=0;v<w;v++){g=a[v];s=0;for(z=g.convertedTypes.length;s<z;s++){var m=g,n=g.convertedTypes[s],p=t.getAttribute(k);if(!m.distinct||!(0<p&&-1<u.indexOf(f[p],n))){if(g.mappingMode===l.attribute){var m=t,n=g,p=s,r=m.getAttributeNode(n.convertedTypes[p]);r&&r.specified&&(r=G(r.nodeValue),n.callback(m,n.types[p],r),c(m,n,n.convertedTypes[p]))}g.mappingMode===l.element&&(m=t,n=g,p=s,m.nodeName.toLowerCase()==n.convertedTypes[p]&&
(r=J(m),n.callback(m,n.types[p],r),c(m,n,n.convertedTypes[p])))}}}t=q&&d[--q];if(b()>x.mappingTimeoutMs){e(x.mappingWaitTimeMs);return}}A.resolve()});return A},c=function(a,b,c){b.distinct&&(b=a.getAttribute(k),b||(b=g++,a.setAttribute(k,b)),f[b]=f[b]||[],f[b].push(c))},f={},k="data-declarative-id",g=1;a.exports=function(a){a=q.get(a);a=u.ensureArray(a);return b(a)};return a.exports}({exports:{}}),L=function(a){a.exports=function(){for(var a=[],d=q.getAll(),c=0,e=d.length;c<e;c++)a.push(d[c].id);
return w(a)};return a.exports}({exports:{}});return function(a){var b=a.exports;b.mappingModes=l;b.mappings=q;b.applyAllMappings=L;b.settings=x;b.apply=w;return a.exports}({exports:{}})});
