/*

 declarative - Mapper for declarative user interfaces in HTML - version 0.7.0

 Copyright 2012, Alex Lawrence
 Licensed under the MIT license.
 http://www.opensource.org/licenses/MIT

*/
(function(a){a.declarative={}})(window);(function(a){a.versionOfInternetExplorer=function(){var a=-1;navigator.appName=="Microsoft Internet Explorer"&&/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)!=null&&(a=parseFloat(RegExp.$1));return a}})(declarative);(function(a){var e=a.array={};e.ensureArray=function(a){return e.isArray(a)?a:[a]};e.isArray=function(a){return Object.prototype.toString.call(a)==="[object Array]"};e.indexOf=function(a,e){for(var b=0,d=a.length;b<d;b++)if(a[b]==e)return b;return-1}})(declarative);(function(a,e){a.parseOptions=function(a){try{return d(a)}catch(b){throw Error("declarative.parseOptions: JSON parsing error");}};var l,o=RegExp(/'/g),b=RegExp(/(^|,)\s*(\w+)\s*:/g),d=e()==7?function(a){eval("var output = {"+a+"};");return output}:function(a){a=a.replace(b,'$1"$2":');a=a.replace(o,'"');return JSON.parse("{"+a+"}")}})(declarative,declarative.versionOfInternetExplorer);(function(a,e,l){a.mappings={};a.mappings.clear=function(){n={}};a.mappings.add=function(a){for(var a=e(a),j=0,m=a.length;j<m;j++){var k=a[j],c=k;c||b("add","invalid options");c.id||b("add","missing id");c.prefix||b("add","missing prefix");c.types||b("add","missing types");c.types&&!c.types.push&&b("add","invalid types");(!c.callback||typeof c.callback!=="function")&&b("add","invalid callback");var f;a:{f=c.id;var g=void 0;for(g in n)if(n.hasOwnProperty(g)&&g==f){f=true;break a}f=false}f&&b("add",
'duplicate id "'+c.id+'"');c=k;c.prefix=c.prefix.toLowerCase();c.typesAsAttributes=[];f=0;for(g=c.types.length;f<g;f++){var h=d(c.types[f]);c.typesAsAttributes.push(c.prefix+h)}n[k.id]=k}};a.mappings.get=function(a){if(!l(a))return o(a);for(var b=[],d=0,e=a.length;d<e;d++)b.push(o(a[d]));return b};var o=function(a){n[a]||b("get",'invalid id "'+a+'"');return n[a]},b=function(a,b){throw Error("declarative.mappings."+a+": "+b);},d=function(a){return a.replace(h,function(a,b){return"-"+b.toLowerCase()})},
n={},h=RegExp(/([A-Z])/g)})(declarative,declarative.array.ensureArray,declarative.array.isArray);(function(a,e,l){a.apply=function(e){var b=a.mappings.get(e),b=l(b);return{to:function(d){if(!d||typeof d.nodeName!=="string")throw Error("declarative.apply.to: invalid element (DOM object required)");var e=b,h;if(d.querySelectorAll){h=d;var i=[],j,m;for(j=0,m=e.length;j<m;j++)i=i.concat(e[j].typesAsAttributes);i="["+i.join("],[")+"]";h=h.querySelectorAll(i)}else h=d.all?d.all:d.getElementsByTagName("*");m=h.length;for(var k,c=0,f=e.length,g=0,l=0;d;){for(c=0;c<f;c++){i=e[c];for(g=0,l=i.typesAsAttributes.length;g<
l;g++)if((k=d.getAttributeNode&&d.getAttributeNode(i.typesAsAttributes[g]))&&k.specified)j=i.types[g],i.callback(d,j,a.parseOptions(k.nodeValue))}d=m&&h[--m]}}}}})(declarative,declarative.array.indexOf,declarative.array.ensureArray);
