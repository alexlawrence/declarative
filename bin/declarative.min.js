/*

 declarative - HTML parsing library
 Requires JSON.parse

 Copyright 2011, Alex Lawrence
 Licensed under the MIT license.
 http://www.opensource.org/licenses/MIT

*/
(function(a){a.declarative={}})(window);(function(a){a.parseOptions=function(a){a.indexOf('"')>-1&&b("input contains double quotes");try{return a=a.replace(e,'$1"$2":'),a=a.replace(d,'"'),JSON.parse("{"+a+"}")}catch(g){b("JSON parsing error")}};var b=function(a){throw Error("declarative.parseOptions: "+a);},d=RegExp(/'/g),e=RegExp(/(^|,)(\w+)\s*:/g)})(declarative);(function(a){a.mappings={};a.mappings.clear=function(){d={}};a.mappings.add=function(a){a||b("add","invalid options");a.id||b("add","missing id");a.attributePrefix||b("add","missing attributePrefix");d[a.id]=a};a.mappings.get=function(a){d[a]||b("get",'invalid id "'+a+'"');return d[a]};var b=function(a,b){throw Error("declarative.mappings."+a+": "+b);},d={}})(declarative);(function(a){a.apply=function(i){var f=a.mappings.get(i);return{to:function(a){b(f,a)}}};var b=function(a,f){if(!f||typeof f.nodeName!=="string")throw Error("declarative.apply.to: invalid element (DOM object required)");for(var c=a.attributePrefix.toLowerCase(),b=a.validTypes,l=a.callback,j=f.getElementsByTagName("*"),h=f,e=j.length,g;h;)g=h.attributes||[],d(g,c,function(a,f){var c;if(!(c=!b)){a:{c=0;for(var d=b.length;c<d;c++)if(b[c]==a)break a;c=-1}c=c>-1}c&&l(h,a,f)}),h=e&&j[--e]},d=function(b,
f,c){e(b,function(b,d){if(b.indexOf(f)==0){var e=k(b,f),i=a.parseOptions(d);c(e,i)}})},e=function(a,b){var c,d=a.length,e;for(c=0;c<d;c++)e=a[c],b(e.nodeName,e.nodeValue)},k=function(a,b){var c=a.substring(b.length),c=c.toLowerCase();return c=c.replace(g,function(a,b){return b.toUpperCase()})},g=RegExp(/-(.)/g)})(declarative);
